%\documentclass{article}

\input{preamble}

\setminted{
frame=lines,
framesep=2mm,
baselinestretch=0.2,
fontsize=\footnotesize,
linenos
}

%\addbibresource{Projecte_A.bib}
%\usepackage{graphicx}

\title{Projecte A - Grafs}
\author{
Aleix Boné Ribó\\
Alex Herrero Pons\\
Alex González Godoy\\
Albert Mercadé Plasencia\\
}
\date{Setembre 2019}

\begin{document}

\thispagestyle{empty}
\clearpage
\setcounter{page}{-1}

\begin{titlepage}
{
    \centering
    \null
    \vfill
    {\Large Projecte d'Algorísmia\par}
    \vspace{2em}
    {\Huge \bfseries 
    Transició de fase i components connexes en grafs aleatoris
    \par}
    \vspace{2em}
    {\large \scshape 
    Grau A \qquad Tardor Curs 2019-2020
    \par}
    \vfill
\begin{center}
    
\end{center}
    \vspace{3cm}

    \vfill
    {\raggedleft \large
Aleix Boné Ribó\\
Alex Herrero Pons\\
Alex González Godoy\\
Albert Mercadé Plasencia\\
        \par}
}
\end{titlepage}

\pagebreak
\pagenumbering{Roman} 

\tableofcontents
\pagebreak
\pagenumbering{arabic} 

\section{Introducció}
En aquest projecte teníem com a objectiu la investigació de les transicions de fase en algunes propietats dels models de grafs aleatoris Random Binomial Graph (RBG) i Random Geometric Graph (RGG). La connectivitat d'aquests models de grafs és la primera propietat que se'ns demanava explorar, a més, també se'ns requeria indagar sobre la mida esperada de la component connexa més gran al graf. En quant a les propietats extres que nosaltres em escollit per ampliar la nostra investigació, ens hem decantat per:

\begin{itemize}
    \item Existència de camins i cicles Eulerians.
    \item Existència de cicles.
\end{itemize}



\section{Implementació de la classe \texttt{Graph}}
Per representar els grafs hem implementat una classe \texttt{Graph} que utilitza llistes d'adjacències donat que són més barates en memòria i la implementació d'un \texttt{Breadth First Search (BFS)} menys costosa en comparació amb les matrius d'adjacència.

\begin{listing}
\inputminted{cpp}{src/graph.h}
\caption{Graph.h}
\end{listing}

Dins d'aquesta classe hem implementat la constructora, que inicialitza la llista d'adjacència, i també els següents mètodes:
\begin{itemize}
    \item\texttt{addUndirectedEdge}: donats els identificadors de dos vèrtexs a i b, crea una aresta no dirigida entre ells.
    \item\texttt{addDirectedEdge}: donats els identificadors de dos vèrtexs crea una aresta dirigida entre ells.
    \item\textt{hasCycles}: retorna un booleà que indica si el graf te cicles. Està implementat utilitzant el mètode \texttt{BFS}.
    \item\textt{EulerianCycleAndEulerianPath}: expliquem més endavant la seva utilitat e implementació.
    \item\texttt{ConnectedComponents}: expliquem més endavant la seva utilitat e implementació.
    \item\texttt{isConnected}: retorna un booleà que indica si el graf és connex. Està implementat amb un \texttt{BFS}.
    \item\texttt{neighbours}: retorna una llista que conté els veïns del vèrtex.
    \item\texttt{print}: imprimeix per pantalla la morfologia del graf. Utilitzat sobretot per fer tests i \textit{debugar}.
\end{itemize}

% ahora el hasCycles quizas hay que poner que lo explicamos luego no? Supongo no se si hace falta meter lo de lo explicamos luego en todos o lo metemos en general. Como quede mas limpio 
% jajaja okay yo haria esto:

\section{Generació dels Grafs}
\subsection{Random Binomial Graphs}
Per generar un Random Binomial Graph (RBG) ens hem basat en el model d'Erdős-Rényi \cite{Erdos1960OnGraphs,Erdos1959OnI} que per un graf $G=(V,E)$ diu que

\begin{equation}
    \forall u,v \in V,\quad (u,v) \in E \text{ amb probabilitat } p
\end{equation}

Hem implementat l'algoritme prèviament descrit sota la funció \texttt{RBG}\footnote{Implementada a src/graph\_generator.cpp}. Per cada vèrtex veiem totes les possible arestes i seguint una distribució de Bernoulli amb probabilitat $p$ decidim quines afegim i quines no.

\subsection{Random Geometric Graphs}
En un Random Geometric Graph (RGG)\cite{Diaz2007On} per a tot vèrtex $v \in V$ se li assigna unes coordenades ($x_v, y_v$) aleatòries entre 0.0 i 1.0 i les arestes entre dos vèrtex s'afageixen si

\begin{align}
    \forall u,v \in V,\quad (u,v) \in E \Longleftrightarrow \text{dist}(u,v) &\leq r \\
    \text{dist}(u,v) &= \sqrt{\left(x_v - x_u\right)^2 + \left(y_v - y_u\right)^2}
\end{align}

La creació dels RGGs la fem sota la funció \texttt{RGG}\footnote{Implementada a src/graph\_generator.cpp}, on assignem a cada vèrtex unes coordenades aleatòries amb una \texttt{uniform\_real\_distribution}. Després per cada vèrtex iterem la resta i afegim una aresta quan la distància entre els dos vèrtex és menor o igual que el radi \textit{r}.

\section{Càlcul Adaptatiu}

Per fer les gràfiques, vam repetir cada experiment 500 vegades fent la mitjana per a cada valor de $p$ o $r$.

Al fer les primeres gràfiques ens vam adonar que la gran majoria de punts eren o bé 0, o 1 i la zona de transició de fase
era sovint en un interval molt petit. Per tal d'evitar calcular punts innecessaris al fer les gràfiques però tenir una
bona resolució en l'interval en que es produïa el canvi de fase, vam decidir implementar un mètode de \emph{sampling}
adaptatiu. \footnote{Implementat a src/adaptative_calc.cpp}

El mètode utilitzat consisteix en dividir els valors de 0 a 1 en 11 punts (0, 0.1, 0.2 ...) i calcular per a cada un dels
punts la mitjana de les 500 repeticions. Un cop feta la primera pasada, mirem si hi ha dos valors consecutis en que la
diferència es maj

\section{Experiments}
\subsection{Probabilitat de ser connex}
%Hipotesis:
En aquest primer experiment la nostra hipòtesi és que sí que trobarem una transició de fase en ambdós casos. En el cas del \texttt{BRG} a mesura que augmenta la probabilitat \emph{p} de que existeixin arestes entre els vèrtex té una certa lògica que augmenti també la probabilitat de ser connex. D'altra banda, en el cas del \textt{RGG}


%Código:
\begin{listing}
\inputminted[firstline=83,lastline=122]{cpp}{src/graph.cpp}
\caption{Funció de ConnectedComponents a graph.cpp}
\end{listing}

Per poder comprovar la hipòtesi i saber quantes components connexes (\textit{cc}) té el \texttt{Random Graph} generat, hem escrit la funció ConnectedComponents a graph.cpp, la qual mitjançant l'algoritme de cerca \texttt{BFS} analitza el gràfic en busca de \textit{cc}. Com es veu en el codi, primerament s'inicialitza un vector de booleans per saber quins vèrtexs ja han estat visitats. Començant pel primer vèrtex i amb l'ajuda d'una cua, es recorren els vèrtexs adjacents no visitats encara mentre s'afegeixen a la cua els veïns d'aquests. Durant la cerca, es manté un comptador de \textit{cc} trobades que s'augmenta quan ja s'han visitat tots els vèrtex de la \textit{cc} actual. Un cop la cua ja està buida, és a dir, no hi ha més vèrtexs de la \textit{cc} per visitar, es busca el següent vèrtex no visitat per analitzar una nova component. Finalment retorna un \textit{pair} amb la quantitat de \textit{cc} que hi ha i la mida de la major.

%hola aqui explicas lo de "la grandària de la \textit{cc} que s'esta analitzant en aquell moment i la mida de la més gran del gràfic" que esto seria en CC més gran, borralo

%Resultados:
\begin{figure}[H]
    \centering
    \includegraphics[width=10cm]{plots/bin_mult_2_04.pdf}
    \caption{Connectivitat de BRG per diferents valors de \textit{n}}
    \label{fig:connect_04}
\end{figure}

A l'hora d'analitzar els resultats i poder constatar la transició de fase hem plasmat les dades obtingudes en un gràfic on es representa la connectivitat de \texttt{BRG} per diferents valors de \textit{n} i per tota possibilitat \textit{p}. Per diferenciar millor els comportaments depenent del nombre de vèrtexs, hem fet un altre gràfic com el de la Figura 1 acotant a $p\leq$ 0.4. Finalment, per poder veure més clarament aquesta transició hem fet un altre gràfic però en aquest cas fins $p\leq$ 0.15\footnote{Binomial Random Graph $p\leq$ 0.15}, de manera que podem dir que la transició de fase es troba entre 0.01 i 0.04.


\begin{figure}[H]
    \centering
    \includegraphics[width=10cm]{plots/geo_mult_2_03.pdf}
    \caption{Connectivitat de RGG per diferents valors de \textit{n}}
    \label{fig:connect_04}
\end{figure}

En el cas del \texttt{RGG} hem creat dos gràfics on ambdós es representen els resultats respecte la connectivitat per a diferents valors de \textit{n} depenent de la grandària del radi \textit{r}. Però per poder definir la transició de fase, en aquest cas utilitzem el gràfic de la Figura 2 on només representem els resultats fins $r\leq$ 0.3. Finalment obtenim que la transició de fase es troba entre 0.07 i 0.11.


\subsection{Mida esperada CC més gran}
%Hipotesis:
Per aquest experiment, pels mateixos motius que la connectivitat i sabent que estàvem en lo cert, vam pensar que seria coherent que la mida esperada de la CC més gran també tingués transició de fase, tant en BRG com en RGG.

%Código: (el mismo que Probabilitat de ser connex)
El codi que hem utilitzat en aquest cas ha sigut el mateix que per la probabilitat de ser connex mostrat més amunt en el \textit{Listing 2}, pero hem afegit dues variables (per tal de comprovar quina component era la més gran.

%Resultados:
\begin{figure}[H]
    \centering
    \includegraphics[width=10cm]{plots/BRG_midaCompConMax.pdf}
    \caption{Mida esperada de la CC més gran de BRG per diferents valors de \textit{n}}
    \label{fig:connect_04}
\end{figure}

Amb els resultats obtinguts es pot veure clarament una transició de fase propera a \textit{p=}0.05, la qual era en certa mida previsible després dels resultats de la connectivitat de \texttt{BRG} per a diferents valors de \textit{n}, ja que la mida d'una component connexa gegant és inversament proporcional a la quantitat de components connexes. %AQUI NS SI ME ACABO DE FLIPAR.

\begin{figure}[H]
    \centering
    \includegraphics[width=10cm]{plots/GRG_midaCompConMax.pdf}
    \caption{Mida esperada de la CC més gran de RGG per diferents valors de \textit{n}}
    \label{fig:connect_04}
\end{figure}

En el cas de \texttt{RGG} els resultats representats ens ajuden a veure una transició de fase ben marcada a \textit{p=0.1} la qual correspon a la obtinguda en el anàlisi de la connectivitat de \texttt{RGG} per diferents valors de \textit{n}. Com esmentat anteriorment, aquests resultats venen justificats pel fet de la proporcionalitat inversa entre el nombre de \textit{cc} i la mida de la component connexa gegant. Igual que antes, ns si me he flipado.

\subsection{Camí i cicle Eulerià}
%Hipotesis:
AQUI FALTA LA HIPOTESIS

%Código:
\begin{listing}
\inputminted[firstline=8,lastline=8]{cpp}{src/graph.h}
\inputminted[firstline=60,lastline=81]{cpp}{src/graph.cpp}
\caption{Funció de EulerianCycleAndEulerianPath en graph.cpp}
\end{listing}

Per determinar si un graf té un cicle eulerià o un camí eulerià hem creat la funció \textit{EulerianCycleAndEulerianPath}. Primerament utilitzant la funció \textit{ConnectedComponents} comprova que tots el vèrtex amb grau \textit{g > 0} pertanyen a una única Component Connexa, si és el cas simplement mirant el nombre de vèrtex amb grau imparell podem classificar si tenen un camí (dos vèrtex imparells) o si tenen un cicle, i per tant també un camí (cap vèrtex imparell).

%Resultados:
\begin{figure}[H]
    \centering
    \includegraphics[width=10cm]{plots/BRG_eulerianCycle.pdf}
    \caption{Eulerian Cycle de BRG per diferents valors de \textit{n}}
    \label{fig:connect_04}
\end{figure}

AQUI FALTA COMENTAR LOS RESULTADOS

\begin{figure}[H]
    \centering
    \includegraphics[width=10cm]{plots/GRG_eulerianCycle.pdf}
    \caption{Eulerian Cycle de RGG per diferents valors de \textit{n}}
    \label{fig:connect_04}
\end{figure}

AQUI FALTA COMENTAR LOS RESULTADOS

\begin{figure}[H]
    \centering
    \includegraphics[width=10cm]{plots/BRG_eulerianPath.pdf}
    \caption{Eulerian Path de BRG per diferents valors de \textit{n}}
    \label{fig:connect_04}
\end{figure}

AQUI FALTA COMENTAR LOS RESULTADOS

\begin{figure}[H]
    \centering
    \includegraphics[width=10cm]{plots/GRG_eulerianPath.pdf}
    \caption{Eulerian Path de RGG per diferents valors de \textit{n}}
    \label{fig:connect_04}
\end{figure}

AQUI FALTA COMENTAR LOS RESULTADOS

\subsection{Arbres i boscos}
%Hipotesis:
AQUI FALTA LA HIPOTESIS

%Código:
\begin{listing}
\inputminted[firstline=27,lastline=57]{cpp}{src/graph.cpp}
\caption{Funció de hasCylces Funció TreeAndForest en graph.cpp}
\end{listing}

AQUI FALTA COMENTAR EL CÓDIGO

%Resultados:
\begin{figure}[H]
    \centering
    \includegraphics[width=10cm]{plots/BRG_cicle.pdf}
    \caption{Probabilitat de tenir un cicle de BRG per diferents valors de \textit{n}}
    \label{fig:connect_04}
\end{figure}

AQUI FALTA COMENTAR LOS RESULTADOS

\begin{figure}[H]
    \centering
    \includegraphics[width=10cm]{plots/GRG_cicle.pdf}
    \caption{Probabilitat de tenir un cicle de RGG per diferents valors de \textit{n}}
    \label{fig:connect_04}
\end{figure}

AQUI FALTA COMENTAR LOS RESULTADOS

\section{Possibles futurs experiments}
Com a possibles experiments que finalment no hem pogut investigar havíem pensat en veure si hi ha transició de fase en la probabilitat de que hi hagi un camí o cicle Hamiltonià. A més també hem considerat indagar la existència de transició de fase de que els grafs siguin bipartits.


\section{Conclusions}

\pagebreak

\printbibliography

\end{document}
